@using Mictlanix.BE
@using Mictlanix.BE.Model
@using Mictlanix.BE.Web.Helpers
@model Supplier

@{
    ViewBag.Title = Resources.Details;
    var CurrentUser = Html.CurrentUser() ?? new User();
    var Privilege = Html.GetPrivilege(CurrentUser, SystemObjects.Suppliers);
    var AllowCreateAddresses = Html.GetPrivilege(CurrentUser, SystemObjects.Addresses).AllowCreate;
    var AllowCreateContacts = Html.GetPrivilege(CurrentUser, SystemObjects.Contacts).AllowCreate;
    var AllowCreateBankAccounts = Html.GetPrivilege(CurrentUser, SystemObjects.BankAccounts).AllowCreate;
    var AllowCreateAgreements = Html.GetPrivilege(CurrentUser, SystemObjects.SupplierAgreements).AllowCreate;
}

<h2>@Resources.Details</h2>
<fieldset>
    <legend>@Resources.Title_Supplier</legend>

	<div class="row-fluid">
	  	<div class="span3">@Html.LabelFor(x => x.Code)</div>
		<div class="span9">@Html.LabelFor(x => x.Name)</div>
	</div>
	<div class="row-fluid">
	  	<div class="span3"><div class="ro-field">@Html.DisplayFor(x => x.Code)</div></div>
		<div class="span9"><div class="ro-field">@Html.DisplayFor(x => x.Name)</div></div>
	</div>
	<div class="row-fluid">
	  	<div class="span4">@Html.LabelFor(x => x.Zone)</div>
		<div class="span4">@Html.LabelFor(x => x.CreditLimit)</div>
	  	<div class="span4">@Html.LabelFor(x => x.CreditDays)</div>
	</div>
	<div class="row-fluid">
	  	<div class="span4"><div class="ro-field">@Html.DisplayFor(x => x.Zone)</div></div>
		<div class="span4"><div class="ro-field">@Html.DisplayFor(x => x.CreditLimit)</div></div>
	  	<div class="span4"><div class="ro-field">@Html.DisplayFor(x => x.CreditDays)</div></div>
	</div>
	<div class="row-fluid">
	  	<div class="span12">@Html.LabelFor(x => x.Comment)</div>
	</div>
	<div class="row-fluid">
	  	<div class="span12"><div class="ro-field">@Html.DisplayFor(x => x.Comment)</div></div>
	</div>
</fieldset>
<div id="tabs">
    <ul>
        <li><a href="#tabs-1">@Resources.Addresses</a></li>
        <li><a href="#tabs-2">@Resources.Contacts</a></li>
        <li><a href="#tabs-3">@Resources.DisplayName_BankAccounts</a></li>
        <li><a href="#tabs-4">@Resources.DisplayName_SupplierAgreements</a></li>
    </ul>
    <div id="tabs-1">
    @if(AllowCreateAddresses) {
        <p>@Html.ActionLink(Resources.CreateNew, "CreateSupplierAddress", "Addresses", new { id = Model.Id }, new { @class = "button icon add openDialog", data_dialog_id = "addressDlg", data_dialog_title = Resources.New })</p>
    }
        <div id='addresses' data-url='@Url.Action("Addresses", new { id = Model.Id })'>@Html.Partial("../Addresses/_Index", Model.Addresses)</div>
    </div>
    <div id="tabs-2">
    @if(AllowCreateContacts) {
        <p>@Html.ActionLink(Resources.CreateNew, "CreateSupplierContact", "Contacts", new { id = Model.Id }, new { @class = "button icon add openDialog", data_dialog_id = "contactDlg", data_dialog_title = Resources.New })</p>
    }
        <div id='contacts' data-url='@Url.Action("Contacts", new { id = Model.Id })'>@Html.Partial("../Contacts/_Index", Model.Contacts)</div>
    </div>
    <div id="tabs-3">
    @if(AllowCreateBankAccounts) {
        <p>@Html.ActionLink(Resources.CreateNew, "CreateForSupplier", "BankAccounts", new { id = Model.Id }, new { @class = "button icon add" })</p>
    }
        @Html.Partial("../BankAccounts/_Index", Model.BanksAccounts)
    </div>
    <div id="tabs-4">
    @if(AllowCreateAgreements) {
        <p>@Html.ActionLink(Resources.CreateNew, "CreateForSupplier", "SupplierAgreements", new { id = Model.Id }, new { @class = "button icon add" })</p>
    }
        @Html.Partial("../SupplierAgreements/_Index", Model.Agreements)
    </div>
</div>
<div class="row-fluid vspaced">
    @Html.ActionLink(Resources.BackToList, "Index", new { }, new { @class = "button icon back" })
@if(Privilege.AllowUpdate) {
	@Html.ActionLink(Resources.Edit, "Edit", new { id = Model.Id }, new { @class = "button icon edit pull-right" })
}
</div>
<script type='text/javascript'>
$('#tabs').tabs();
</script>