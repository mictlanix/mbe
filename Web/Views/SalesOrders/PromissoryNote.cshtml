@using Mictlanix.BE
@using Mictlanix.BE.Model
@using Mictlanix.BE.Web.Models
@using Mictlanix.BE.Web.Helpers
@model SalesOrder

@{
		  var taxpayer = Model.Customer.Taxpayers.FirstOrDefault ();
		  Layout = WebConfig.PrintLayout;
		  ViewBag.WindowTitle = string.Format (Resources.PromissoryNote);
		  ViewBag.Title = Resources.PromissoryNote;
		  ViewBag.Store = Model.Store;
		  //ViewBag.Taxpayer = taxpayer;
		  ViewBag.TaxpayerName = taxpayer.Name;
		  ViewBag.Address = taxpayer.Address;
}

<div class="display-label right floating">
	<h3>@Resources.PromissoryNote @Html.DisplayFor(x => x.Serial)</h3>
</div>
@*<div class="display-label right floating">
    @Html.LabelFor(x => x.Issued)<br/>
    @Html.DisplayFor(x => x.Issued)<br/>
    @Html.LabelFor(x => x.IssuedLocation)<br/>
    @Html.DisplayFor(x => x.IssuedLocation)
</div>

<div class="display-label">
    <h3>@Html.LabelFor(x => x.Recipient)</h3>
</div>
<div class="display-field">
    @Resources.TaxpayerId
    @Html.DisplayFor(x => x.Recipient)<br/>
    @Html.DisplayFor(x => x.RecipientName)<br/>
    @Html.DisplayFor(x => x.RecipientAddress.Street)
    @Html.DisplayFor(x => x.RecipientAddress.ExteriorNumber)
    @Html.DisplayFor(x => x.RecipientAddress.InteriorNumber)<br/>
    @Html.DisplayFor(x => x.RecipientAddress.Neighborhood),
    @Html.DisplayFor(x => x.RecipientAddress.Borough)<br/>
    @Html.DisplayFor(x => x.RecipientAddress.State),
    @Html.DisplayFor(x => x.RecipientAddress.Country),
    @Html.DisplayFor(x => x.Customer.Addresses.FirstOrDefault())
</div>*@

<table>
    <tr>
        <th class="line nowrap"></th>
        <th class="line nowrap">@Resources.UnitOfMeasurement</th>
        <th class="line nowrap">@Resources.ProductCode</th>
        <th class="line">@Resources.ProductName</th>
        <th class="line nowrap">@Resources.Price</th>
        <th class="line nowrap">@Resources.VAT</th>
        <th class="line nowrap">@Resources.Amount</th>
    </tr>
	@foreach (var item in Model.Details) {
    <tr>
        <td class="number line">@Html.DisplayFor(x => item.Quantity)</td>
        <td class="center line">@Html.DisplayFor(x => item.Product.UnitOfMeasurement)</td>
        <td class="center line">@Html.DisplayFor(x => item.ProductCode)</td>
        <td class="line">@Html.DisplayFor(x => item.ProductName)</td>
        <td class="number line">@Html.DisplayFor(x => item.Price)</td>
        <td class="number line">@Html.DisplayFor(x => item.TaxRate)</td>
        <td class="number line">@Html.DisplayFor(x => item.Subtotal)</td>
    </tr>
	}
</table>

<table>
    <tr>
        <td rowspan="3" class="center">@Html.CurrencyToString(Model.Total, Model.Currency)</td>
        <td class="number">@Html.LabelFor(x => x.Subtotal)</td>
        <td class="number">@Html.DisplayFor(x => x.Subtotal)</td>
    </tr>
    <tr>
        <td class="number">@Html.LabelFor(x => x.Taxes)</td>
        <td class="number">@Html.DisplayFor(x => x.Taxes)</td>
    </tr>
    <tr>
        <td class="number">@Html.LabelFor(x => x.Total)</td>
        <td class="number">@Html.DisplayFor(x => x.Total)</td>
    </tr>
</table>
<p class="right">@string.Format(Resources.PromissoryNoteLegend, WebConfig.Company)</p>
<div class="right" style="transform: rotate(270deg);
	transform-origin: right top 0;">@Resources.UnauthorizedReproductionLegend</div>
